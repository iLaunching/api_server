# Railway Deployment Guide - API Server

## ğŸš€ Quick Deploy

### 1. Login to Railway
```bash
railway login
```

### 2. Create New Project
```bash
railway init
# Choose: "Create a new project"
# Project name: "business-ai-advisor"
```

### 3. Deploy API Server
```bash
cd api-server
railway up
```

## ğŸ”§ Environment Variables

Set these in Railway dashboard after deployment:

### Required (for basic functionality)
```bash
# Application settings
DEBUG=false
LOG_LEVEL=INFO

# Will be added in next steps:
# DATABASE_URL=postgresql://... (auto-generated by Railway)
# REDIS_URL=redis://... (auto-generated by Railway)
```

### Optional (for full AI functionality - add later)
```bash
# AI API Keys
ANTHROPIC_API_KEY=sk-ant-your-key-here
OPENAI_API_KEY=sk-your-openai-key-here

# External Data APIs
REDDIT_CLIENT_ID=your_reddit_client_id
REDDIT_CLIENT_SECRET=your_reddit_client_secret
TWITTER_BEARER_TOKEN=your_twitter_bearer_token
```

## ğŸ“‹ Deployment Steps

### Step 1: Initial Deployment
1. Navigate to api-server directory
2. Run `railway up`
3. Wait for build and deployment
4. Get your Railway URL from dashboard

### Step 2: Configure Domain
1. Go to Railway dashboard
2. Click on your service
3. Go to "Settings" â†’ "Domains"
4. Generate domain or add custom domain

### Step 3: Test Deployment
```bash
# Test health endpoint
curl https://your-app.railway.app/health

# Test API documentation
curl https://your-app.railway.app/docs

# Test analysis endpoint
curl -X POST https://your-app.railway.app/api/v1/analyze \
  -H "Content-Type: application/json" \
  -d '{"company_name": "TestCorp", "industry": "technology"}'
```

## ğŸ” Monitoring

### Railway Dashboard
- View logs: Railway dashboard â†’ Service â†’ Logs
- Monitor metrics: Railway dashboard â†’ Service â†’ Metrics
- Check deployments: Railway dashboard â†’ Service â†’ Deployments

### Health Check
The service includes a comprehensive health check at `/health`:
```json
{
  "status": "healthy|degraded",
  "timestamp": "2025-10-05T18:30:00Z",
  "service": "api-server",
  "version": "1.0.0",
  "redis": "connected|not_configured|error",
  "websocket_connections": 0
}
```

## ğŸ› Troubleshooting

### Common Issues

#### 1. Build Failures
- Check Dockerfile syntax
- Verify requirements.txt dependencies
- Check logs in Railway dashboard

#### 2. Service Won't Start
- Verify PORT environment variable
- Check application logs
- Ensure health check endpoint is accessible

#### 3. WebSocket Issues
- Verify WebSocket connections work
- Check CORS configuration
- Test with WebSocket client

### Debug Commands
```bash
# View recent logs
railway logs

# Check service status
railway status

# Redeploy service
railway up --detach

# Connect to service shell (if needed)
railway shell
```

## ğŸ”— Integration with Bubble

Once deployed, update your Bubble app settings:

1. **API Endpoint**: Replace localhost with your Railway URL
   - Old: `http://localhost:8000`
   - New: `https://your-app.railway.app`

2. **WebSocket URL**: Update WebSocket connections
   - Old: `ws://localhost:8000/ws/{session_id}`
   - New: `wss://your-app.railway.app/ws/{session_id}`

3. **CORS Settings**: Already configured for `*.bubbleapps.io`

## ğŸ“ˆ Scaling

Railway auto-scales based on demand:
- **CPU**: Auto-scales up to handle load
- **Memory**: 512MB default, increases as needed
- **Replicas**: Can configure multiple instances

For high traffic:
1. Go to Railway dashboard
2. Service â†’ Settings â†’ Resources
3. Increase memory/CPU limits
4. Enable multiple replicas

## ğŸ’° Cost Estimation

**Starter Plan** (Free tier):
- $5/month for basic usage
- 500 hours execution time
- 1GB outbound bandwidth

**Pro Plan** (Recommended):
- $20/month base + usage
- Unlimited execution time
- Priority support
- Custom domains

## ğŸ”„ Next Steps

After successful deployment:
1. âœ… Test with your Bubble app
2. ğŸ”„ Add Redis and PostgreSQL (Todo #4)
3. ğŸ”„ Deploy LLM Gateway service
4. ğŸ”„ Configure service-to-service networking